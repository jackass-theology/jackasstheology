var tdcWindowFrame;
(function(b,c){tdcWindowFrame={_isInitialized:!1,_arrCssSelectors:[],_inMoving:!1,_inResizing:!1,$_currentWindowFrame:c,$_tdcIframeCover:c,$_tdcSidebar:c,$_window:c,_currentWindowPosition:c,_lastZIndex:1E3,_resizeOffset:c,_markerCssClass:"tdc-window-frame",init:function(a){if(!tdcWindowFrame._isInitialized){tdcWindowFrame._arrCssSelectors=a;tdcWindowFrame.$_window=b(window);tdcWindowFrame.$_tdcIframeCover=b("#tdc-iframe-cover");tdcWindowFrame.$_tdcSidebar=b("#tdc-sidebar");for(var d=b("body"),e="",
f="",k=0;k<a.length;k++){var g=a[k]+" > header",h=a[k]+" .tdw-resize";0!==k&&(g=","+g,h=","+h);e+=g;f+=h;b(a[k]).on("mousedown",function(a){a=b(this);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)})}d.on("mousedown",e,function(a){a.currentTarget===a.target&&(tdcWindowFrame.$_currentWindowFrame=b(a.currentTarget).parent(),tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame),tdcWindowFrame._inMoving=!0,tdcWindowFrame.setCurrentWindowFramePosition(a),tdcWindowFrame.setMouseInitialPosition({left:a.pageX,
top:a.pageY}),tdcWindowFrame._disableCurrentWindowContent())}).on("mouseup",e,function(a){a.currentTarget===a.target&&(tdcWindowFrame._inMoving=!1,tdcWindowFrame.setCurrentWindowFramePosition(a),tdcWindowFrame.setMouseInitialPosition(c),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._enableCurrentWindowContent())}).on("mouseup",function(a){tdcWindowFrame._inMoving=!1;tdcWindowFrame._inResizing=!1;tdcWindowFrame.setCurrentWindowFramePosition(a);tdcWindowFrame.setMouseInitialPosition({left:a.pageX,
top:a.pageY});tdcWindowFrame._resizeOffset=c;tdcWindowFrame._disableBackground(!1)}).on("mousemove",function(a){b(this);if(tdcWindowFrame._inMoving){a.stopPropagation();a.preventDefault();var d=tdcWindowFrame.getMouseInitialPosition();if("undefined"!==typeof d){var c=tdcWindowFrame.getCurrentWindowFramePosition();tdcWindowFrame.$_currentWindowFrame.css({left:a.pageX-(d.left-c.left),top:a.pageY-(d.top-c.top)});tdcWindowFrame.$_currentWindowFrame.addClass("clear-position");tdcWindowFrame._disableBackground()}}else if(tdcWindowFrame._inResizing&&
(a.stopPropagation(),a.preventDefault(),d=tdcWindowFrame.getMouseInitialPosition(),"undefined"!==typeof d)){var e={offsetLeft:0,offsetTop:0};_.isUndefined(tdcWindowFrame._resizeOffset)||(e=tdcWindowFrame._resizeOffset);c=tdcWindowFrame.getCurrentWindowFramePosition();d=a.pageX-c.left+e.width-e.offsetLeft;a=a.pageY-c.top+e.height-e.offsetTop;tdcWindowFrame.$_currentWindowFrame.css({width:d,height:a});tdcWindowFrame.$_currentWindowFrame.data("width",d);tdcWindowFrame.$_currentWindowFrame.data("height",
a);tdcWindowFrame._timerResize=setTimeout(function(){"undefined"!==typeof tdcWindowFrame._timerResize&&(clearTimeout(tdcWindowFrame._timerResize),editor.resize(!0))},100);tdcWindowFrame._disableBackground()}}).on("mousedown",f,function(a){if(a.currentTarget===a.target){var d=b(a.currentTarget);tdcWindowFrame.$_currentWindowFrame=b(a.currentTarget).closest("."+tdcWindowFrame._markerCssClass);tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame);tdcWindowFrame._inResizing=!0;tdcWindowFrame.setCurrentWindowFramePosition(a);
tdcWindowFrame.setMouseInitialPosition({left:a.pageX,top:a.pageY});tdcWindowFrame._resizeOffset={width:d.width(),height:d.height(),offsetLeft:a.pageX-d.offset().left,offsetTop:a.pageY-d.offset().top}}}).on("mouseup",f,function(a){a.currentTarget===a.target&&(tdcWindowFrame._inResizing=!1,tdcWindowFrame.setMouseInitialPosition(c),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._resizeOffset=c)}).on("click",".tdw-css-writer-expand .tdw-expand-collapse, .tdw-close, .tdc-iframe-close-button",function(a){a.currentTarget===
a.target&&(a=b(a.currentTarget).closest(".tdc-window-frame"),"tdw-css-writer"!==a.attr("id")&&(a.removeClass("clear-position"),a.css({left:"",top:""})),tdcWindowFrame.unsetWindowFrame(a))}).on("mousedown",".tdc-window-frame",function(a){a=b(a.currentTarget);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)});tdcWindowFrame.$_window.on("resize",function(){b("."+tdcWindowFrame._markerCssClass).each(function(a,d){var c=b(d),e={},f=c.offset();f.left+100>tdcWindowFrame.$_window.width()&&(e.left=
tdcWindowFrame.$_window.width()-100);f.top+100>tdcWindowFrame.$_window.height()&&(e.top=tdcWindowFrame.$_window.height()-100);b.isEmptyObject(e)||c.css(e)});tdcContextMenu.hide()});tdcWindowFrame._isInitialized=!0}},getCurrentWindowFramePosition:function(){return tdcWindowFrame._currentWindowPosition},setCurrentWindowFramePosition:function(a){tdcWindowFrame._currentWindowPosition="undefined"===typeof tdcWindowFrame.$_currentWindowFrame?c:tdcWindowFrame.$_currentWindowFrame.offset()},setMouseInitialPosition:function(a){tdcWindowFrame._mouseInitialPosition=
a},getMouseInitialPosition:function(){return tdcWindowFrame._mouseInitialPosition},_disableBackground:function(a){"undefined"!==typeof a&&!1===a?tdcWindowFrame.$_tdcIframeCover.removeClass("tdc-iframe-cover-transparent"):tdcWindowFrame.$_tdcIframeCover.addClass("tdc-iframe-cover-transparent")},_enableCurrentWindowContent:function(){"undefined"!==typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events","")},_disableCurrentWindowContent:function(){"undefined"!==
typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events","none")},setWindowFrame:function(a){b("."+tdcWindowFrame._markerCssClass).addClass("tdw-inactive");a.addClass(tdcWindowFrame._markerCssClass);tdcWindowFrame.$_tdcIframeCover.css({"z-index":++tdcWindowFrame._lastZIndex});a.css({"z-index":++tdcWindowFrame._lastZIndex});a.removeClass("tdw-inactive")},unsetWindowFrame:function(a){a.removeClass(tdcWindowFrame._markerCssClass);setTimeout(function(){tdcWindowFrame.activeLastWindowFrame()},
50)},activeLastWindowFrame:function(){var a=c,d=-1;b("."+tdcWindowFrame._markerCssClass).each(function(e,c){var f=b(c),g=parseInt(f.css("z-index"));g>d&&(d=g,a=f)});"undefined"!==typeof a&&(console.log(d),a.removeClass("tdw-inactive"))},getMarkerCssClass:function(){return tdcWindowFrame._markerCssClass}};b(window).load(function(){tdcWindowFrame.init(["#tdw-css-writer","#tdc-menu-settings","#tdc-page-settings","#tdc-wpeditor"])})})(jQuery);var tdcNotice;
(function(b,c){tdcNotice={$_noticeWrapper:c,_isInitialized:!1,notice:function(a,d,b){var c={};_.isUndefined(d)||!0!==d||(c.type="error");_.isUndefined(b)||!0!==b||(c.hasClose=!0);tdcNotice.showNotice(a,c)},showNotice:function(a,d){if(tdcNotice._isInitialized){var c="",f="",k=!1,g=5E3;if("undefined"!==typeof d){if("undefined"!==typeof d.type)switch(d.type){case "error":c="tdc-notice-error";k=!0;break;case "info":c="tdc-notice-info"}"undefined"!==typeof d.hasClose&&!0===d.hasClose&&(f='<div class="tdc-close-notice"></div>');
"undefined"!==typeof d.timeout&&(g=d.timeout)}var h=b('<div class="tdc-notice '+c+'"><span class="tdc-msg-tag"></span>'+a+f+"</div>");tdcNotice.$_noticeWrapper.append(h);setTimeout(function(){h.addClass("tdc-notice-in")},100);if(k)throw a;setTimeout(function(){h.removeClass("tdc-notice-in")},g-1E3);setTimeout(function(){h.css("margin-top","-"+h.outerHeight()+"px")},g-500);setTimeout(function(){h.remove()},g)}},init:function(){tdcNotice._isInitialized||(tdcNotice.$_noticeWrapper=b('<div class="tdc-notice-wrapper"></div>'),
tdcNotice.$_noticeWrapper.on("click",".tdc-close-notice",function(a){b(this).closest(".tdc-notice").remove()}),b("#tdc-live-iframe-wrapper").append(tdcNotice.$_noticeWrapper),tdcNotice._isInitialized=!0)}};tdcNotice.init()})(jQuery);var tdcShortcodeParser={};
(function(){tdcShortcodeParser={levels:{},init:function(b){tdcShortcodeParser.levels=_.clone(b);tdcShortcodeParser.levels[2]=tdcShortcodeParser.levels[2].concat(tdcShortcodeParser.levels[4])},multiNext:function(b,c){for(var a=tdcShortcodeParser.levels[b],d,e=0;e<a.length;e++){var f=tdcShortcodeParser.generateTreeElement(wp.shortcode.next(a[e],c));"undefined"!==typeof f&&("undefined"===typeof d||d.index>f.index)&&(d=f)}return d},parse:function(b,c){for(var a=tdcShortcodeParser.multiNext(b,c),d=0,e=
[];"undefined"!==typeof a&&5E3>d;)c=c.substring(a.index+a.content.length),4>b&&(a.child=tdcShortcodeParser.parse(b+1,a.content)),e.push(a),a=tdcShortcodeParser.multiNext(b,c),d++;return e},generateTreeElement:function(b){return b}}})();var tdcInit={};
(function(b,c,a){tdcInit={$formPost:a,_title:"TagDiv Composer Draft",_url:"",$title:a,$titlePromptText:a,$contentWrap:a,$content:a,$contentIfr:a,$originalPostStatus:a,$_wpnonce:a,$postType:a,$postId:a,$postAuthor:a,$excerpt:a,$catslist:a,catslistValue:"",init:function(){tdcInit.$formPost=b("#post");if(tdcInit.$formPost.length){tdcInit.$title=tdcInit.$formPost.find("#title");tdcInit.$titlePromptText=tdcInit.$formPost.find("#title-prompt-text");tdcInit.$contentWrap=tdcInit.$formPost.find("#wp-content-wrap");
tdcInit.$content=tdcInit.$formPost.find("#content");tdcInit.$contentIfr=tdcInit.$formPost.find("#content_ifr");tdcInit.$originalPostStatus=tdcInit.$formPost.find("#original_post_status");tdcInit.$_wpnonce=tdcInit.$formPost.find("#_wpnonce");tdcInit.$postType=tdcInit.$formPost.find("#post_type");tdcInit.$postId=tdcInit.$formPost.find("#post_ID");tdcInit.$postAuthor=tdcInit.$formPost.find("#post_author");tdcInit.$excerpt=tdcInit.$formPost.find("#excerpt");tdcInit.$catslist=tdcInit.$formPost.find("input[type=checkbox][name^=post_category]");
c.each(tdcInit.$catslist,function(a,d,c){a=b(a);a.is(":checked")&&(tdcInit.catslistValue+=a.val()+",")});var a="page";tdcInit.$tdbTemplateType=tdcInit.$formPost.find("#tdb-template-type");tdcInit.$tdbTemplateType.length&&(a=tdcInit.$tdbTemplateType.val());tdcInit._url=window.tdcAdminSettings.adminUrl+"post.php?post_id="+tdcInit.$postId.val()+"&td_action=tdc&tdbTemplateType="+a;"page"!==tdcInit.$postType.val()&&"tdb_templates"!==tdcInit.$postType.val()||!0!==window.tdcAdminSettings.hasUserRights||
window.tdcAdminSettings.isPageForPosts||b('<div class="tdc-panel-button"><div class="tdc-panel-icon"></div><div class="tdc-panel-link"><a onclick="return tdcInit.savePost( event )" href="'+tdcInit._url+'">TagDiv Composer</a></div></div>').insertAfter("div#titlediv")}},_checkPostContent:function(){tdcInit.$title.length&&tdcInit.$titlePromptText.length&&0===tdcInit.$title.val().trim().length&&(tdcInit.$title.val(tdcInit._title),tdcInit.$titlePromptText.hide());tdcShortcodeParser.init({0:["vc_row"],
1:["vc_column"],2:["vc_row_inner"],3:["vc_column_inner"],4:[]});return tdcInit.$contentWrap.hasClass("tmce-active")?tinyMCE.activeEditor.getContent():tdcInit.$formPost.find("#content").val()},savePost:function(a){b(".tdc-panel-button").addClass("tdc-open-editor-loader");setTimeout(function(){b(".tdc-panel-button").removeClass("tdc-open-editor-loader")},2E3);a=tdcInit._checkPostContent();b.ajax({url:window.ajaxurl,type:"POST",data:{"data[wp_autosave][post_id]":tdcInit.$postId.val(),"data[wp_autosave][post_type]":tdcInit.$postType.val(),
"data[wp_autosave][post_author]":tdcInit.$postAuthor.val(),"data[wp_autosave][post_title]":tdcInit.$title.val(),"data[wp_autosave][content]":a,"data[wp_autosave][excerpt]":tdcInit.$excerpt.val(),"data[wp_autosave][catslist]":tdcInit.catslistValue,"data[wp_autosave][auto_draft]":1,"data[wp_autosave][_wpnonce]":tdcInit.$_wpnonce.val(),interval:60,_nonce:window.heartbeatSettings.nonce,action:"heartbeat",screen_id:tdcInit.$postType.val(),has_focus:!1}}).done(function(a,b,d){window.location=tdcInit._url});
return!1}};b(window).ready(function(){tdcInit.init()})})(jQuery,_);var tdcDebug;
(function(b,c){tdcDebug={_debug:!0,_logWindowObj:c,_content:c,_disabled:!1,log:function(a){tdcDebug._debug&&console.log(a)},dumpAllItems:function(){var a=tdcAdminIFrameUI.getIframeWindow();console.group("All items dump:");"undefined"!==typeof a.tdcComposerBlocksApi&&(console.log("%c tdcComposerBlocksApi.items ","background: #222; color: white"),console.log(a.tdcComposerBlocksApi.items));"undefined"!==typeof a.tdPullDown&&(console.log("%c tdPullDown.items ","background: #222; color: white"),console.log(a.tdPullDown.items));
"undefined"!==typeof a.tdAnimationSprite&&(console.log("%c tdAnimationSprite.items ","background: #222; color: white"),console.log(a.tdAnimationSprite.items));"undefined"!==typeof a.tdHomepageFull&&(console.log("%c tdHomepageFull.items ","background: #222; color: white"),console.log(a.tdHomepageFull.items));"undefined"!==typeof a.tdTrendingNow&&(console.log("%c tdTrendingNow.items ","background: #222; color: white"),console.log(a.tdTrendingNow.items));console.groupEnd()},group:function(a,b){!1!==
tdcDebug._debug&&(console.group?console.group(a,b):console.log(a))},groupCollapsed:function(a,b){!1!==tdcDebug._debug&&(console.groupCollapsed?console.groupCollapsed(a,b):console.log(a))},groupEnd:function(){!1!==tdcDebug._debug&&console.groupEnd&&console.groupEnd()},logWindow:function(a){if(c===tdcDebug._logWindowObj){tdcDebug._logWindowObj=b("<div></div>");var d=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Clear</div>'),e=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Disable</div>');
tdcDebug._content=b('<div style="clear: both"></div>');tdcDebug._logWindowObj.append(d);tdcDebug._logWindowObj.append(e);d.click(function(a){tdcDebug._content.html("")});e.click(function(a){tdcDebug._disabled=!tdcDebug._disabled;tdcDebug._disabled?b(this).css("background-color","#FF000"):b(this).css("background-color","")});tdcDebug._logWindowObj.append(tdcDebug._content);b("body").append(tdcDebug._logWindowObj);tdcDebug._logWindowObj.css({width:300,height:500,border:"1px solid red",position:"fixed",
bottom:0,right:20,"background-color":"#FFFFFF",overflow:"scroll","z-index":1E4})}tdcDebug._disabled||tdcDebug._content.html(a+"<br>"+tdcDebug._content.html())}}})(jQuery);
